<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 
 <mapper namespace="client">
 	<insert id="insertClient" parameterType="clientVo">
 		insert into client
 		(
 			C_NO,
 			C_NAME,
 			B_NO,
 			B_NO2,
 			C_TYPE,
 			C_OWNER,
 			C_ADDR,
 			C_PHONE,
 			C_FAX,
 			C_EMAIL,
 			C_CREDITLIMIT,
 			C_CREDIT_MONTH,
 			C_CREDIT_DAY
 		)
 		values
 		(
 			C_NO_SEQ.NEXTVAL,
 			#{cName},
 			${bNo},
 			${bNo2},
 			#{cType},
 			#{cOwner},
 			#{cAddr},
 			#{cPhone},
 			#{cFax},
 			#{cEmail},
 			${cCreditLimit},
 			${cCreditDateMonth},
 			${cCreditDateDay}
 		)
 	</insert>
 	
 	<select id="selectClientCnt" resultType="int">
 		select count(c_no) 
  		from client
  		where c_delete_yn = 'N'
 	</select>
 	
 	<select id="selectClientList" parameterType="pageVo" resultType="clientVo">
  		select * from 
  		(
	  		select rownum rn, c.* 
	  		from(
		  		select * 
		  		from client 
		  		where c_delete_yn = 'N'
		  		order by c_no  		
	  		) c
  		)
  		where rn between #{startRow} and #{endRow}
  	</select>
  	
  	<select id="selectSearchClientCnt" parameterType="string" resultType="int">
 		select count(c_no) 
  		from client
  		where c_delete_yn = 'N' and (
  			c_name like'%${search}%' or c_owner like '%${search}%' or c_addr like '%${search}%'
  		)
 	</select>
 	
 	<select id="selectSearchClientList" parameterType="pageVo" resultType="clientVo">
  		select * from 
  		(
	  		select rownum rn, c.* 
	  		from(
		  		select * 
		  		from client 
		  		where c_delete_yn = 'N'and (
  					c_name like'%${search}%' or c_owner like '%${search}%' or c_addr like '%${search}%'
  				)
		  		order by c_no  		
	  		) c
  		)
  		where rn between #{startRow} and #{endRow}
  	</select>
  	
  	<update id="deleteClient">
  		update client
  		set c_delete_yn = 'Y'
  		where c_no in 
  		<foreach collection="array" item="cNn" open="(" close=")" separator=",">
  			${cNn}  		
  		</foreach>
  	</update>
 	
 </mapper>