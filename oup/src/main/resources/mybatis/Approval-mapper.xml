<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 
 <!-- 파일이름 바꾸기 -->
 
 <mapper namespace="approval">
 	<select id="getODList" resultType="com.kh.oup.approval.vo.ApprovalODVo">
 		SELECT * FROM ORDER1
 	</select>
 	
 	<select id="getODPrice" resultType="int">
 		SELECT SUM(O_PRICE)
		FROM ORDER_LIST
		WHERE O_NO = #{oNo}
 	</select>
 	
 	<select id="getSPList" resultType="com.kh.oup.approval.vo.ApprovalSPVo">
 		SELECT * FROM STATEMENT
 	</select>
 	
 	<select id="getPJList" resultType="com.kh.oup.approval.vo.ApprovalPJVo">
 		SELECT * FROM PROJECT
 	</select>
 	
 	<insert id="appSend" parameterType="com.kh.oup.approval.vo.ApprovalVo">
 		INSERT INTO APPR
 		(
 			A_NO,
 			A_R_NO,
 			D_C_CODE,
 			A_DOC_NO,
 			A_TITLE,
			A_DATE,
			A_E_DATE,
			A_PIC_NAME,
			A_TEAM_NY,
			A_DEC_NY,
			A_ALLDEC_NY,
			A_STATEMENT,
			A_SERVER_NAME,
			A_ORIGIN_NAME
 		)
 		VALUES
 		(
 			SEQ_APPROVAL.NEXTVAL,
 			#{arNo},
 			#{dcCode},
 			#{aDocNo},
 			#{aTitle},
 			SYSDATE,
 			NULL,
 			#{aPicName},
 			'N',
 			'N',
 			'N',
 			'N',
 			#{changeName},
 			#{originName}
 		)
 	</insert>
 	
 	<select id="getSendAppCnt" resultType="int">
 		SELECT COUNT(A_R_NO)
 		FROM APPR
 		WHERE A_PIC_NAME = #{name}
 	</select>
 	
 	<select id="getSendApprovalList" parameterType="HashMap" resultType="com.kh.oup.approval.vo.ApprovalVo">
 		SELECT * FROM 
  		(
	  		SELECT ROWNUM RN, R.* 
	  		 FROM(
                SELECT *
                FROM APPR
                WHERE A_PIC_NAME = #{loginName}
                ORDER BY A_NO DESC
            ) R
  		)
  		WHERE RN BETWEEN #{page.startRow} AND #{page.endRow}
 	</select>
 </mapper>